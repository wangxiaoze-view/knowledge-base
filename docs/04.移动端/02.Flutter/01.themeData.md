---
title: ThemeData
date: 2024-04-12 20:56:10
permalink: /pages/dbd86d
---

每一款系统应用都会有主题相关设置，包含主题色，字体权重大小等等；当然`Fltter`也会有，不过区别的是`Flutter`是官方提供的`ThemeData`; 接下来具体讲一讲`ThemeData`的配置以及它如何使用？

想要使用`ThemeData`，需要先引入`material`包，然后使用`ThemeData`， 使用方式如下：

```dart
import 'package:flutter/material.dart';
class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData(
        /// 这里配置具体的主题内容，如主题色，文本颜色等等
      ),
    );
  }
}
```

`ThemeData`中具体有哪些值呢？

首先先总结一下无配置化的写法：

- `ThemeData.dart()`，默认暗色主题
- `ThemeData.light()`，默认亮色主题
- `ThemeData.fallback({bool? useMaterial3})`，默认主题颜色，与`ThemeData.light()`用法相同
- `ThemeData.from()`,根据给定颜色方案中的颜色和可选文本主题的文本样式创建一个主题。

例子：

```dart
@override
Widget build(BuildContext context) {
  return MaterialApp(
    // 暗色主题
    theme: ThemeData.dark(),

    // 亮色主题 或者 ThemeData.fallbackk()
    theme: ThemeData.light(),

    // 定制化, 后续字体，颜色可以继承使用定制化的样式
    theme: theme: ThemeData.from(
      colorScheme: ColorScheme.fromSeed(seedColor: Colors.deepOrange),
      textTheme: const TextTheme(
        titleLarge: TextStyle(
          fontSize: 50,
        ),
      ),
    ),
  );
}
```

`ThemeData`中具体配置的参数很多很多，颜色主题，文字主题，按钮主题等等；[官网：ThemeData 参数说明](https://api.flutter.dev/flutter/material/ThemeData-class.html)

```dart
/// 要注意的是v2与v3版本的区别，在一些基础上作了修改，具体可以查看官网
ThemeData({
  Brightness? brightness, //深色还是浅色
  MaterialColor? primarySwatch, //主题颜色样本，见下面介绍
  Color? primaryColor, //主色，决定导航栏颜色
  Color? cardColor, //卡片颜色
  Color? dividerColor, //分割线颜色
  ButtonThemeData buttonTheme, //按钮主题
  Color dialogBackgroundColor,//对话框背景颜色
  String fontFamily, //文字字体
  TextTheme textTheme,// 字体主题，包括标题、body等文字样式
  IconThemeData iconTheme, // Icon的默认样式
  TargetPlatform platform, //指定平台，应用特定平台控件风格
  ColorScheme? colorScheme,
  ...
})

```

了解了`ThemeData`的用法之后，我们可以在其基础上写一个切换主题的`Demo`；

```dart

import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    // 应用级顶层容器
    return MaterialApp(
      title: '切换主题',
      debugShowCheckedModeBanner: false,
      home: ThemeTestRoute(),
    );
  }
}


// 因为要切换主题，所以该组件为有状态的组件；
class ThemeTestRoute extends StatefulWidget {
  @override
  _ThemeTestRouteState createState() => _ThemeTestRouteState();
}

class _ThemeTestRouteState extends State<ThemeTestRoute> {

  // 默认当前页面的颜色为teal浅绿色
  var _themeColor = Colors.teal; //当前路由主题色

  @override
  Widget build(BuildContext context) {
    ThemeData themeData = Theme.of(context);
    return Theme(
      // 配置主题色
      data: ThemeData(
        // v2版本使用的是primarySwatch
        primarySwatch: _themeColor, //用于导航栏、FloatingActionButton的背景色等
        // v3版本使用的是colorScheme
        colorScheme: ColorScheme.fromSeed(seedColor: _themeColor),
        // icon的颜色
        iconTheme: IconThemeData(color: _themeColor),
      ),
      child: Scaffold(
        appBar: AppBar(title: Text("主题测试")),
        body: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: <Widget>[
            //第一行Icon使用主题中的iconTheme
            const Row(
              mainAxisAlignment: MainAxisAlignment.center,
              children: <Widget>[
                Icon(Icons.favorite),
                Icon(Icons.airport_shuttle),
                Text("  颜色跟随主题")
              ],
            ),
            //为第二行Icon自定义颜色（固定为黑色)
            Theme(
              data: themeData.copyWith(
                iconTheme: themeData.iconTheme.copyWith(color: Colors.black),
              ),
              child: const Row(
                mainAxisAlignment: MainAxisAlignment.center,
                children: <Widget>[
                  Icon(Icons.favorite),
                  Icon(Icons.airport_shuttle),
                  Text("  颜色固定黑色")
                ],
              ),
            ),
          ],
        ),
        floatingActionButton: FloatingActionButton(
          onPressed: () => //切换主题
            setState(() {
              _themeColor = _themeColor == Colors.teal ? Colors.red : Colors.teal;
            },
          ),
          child: Icon(Icons.palette),
        ),
      ),
    );
  }
}

```

效果如下：

<img src="https://qiniu.wangxiaoze.wang/hexo-blog/iShot_2024-04-13_21.09.05.png" width="300" height="600" />
<img src="https://qiniu.wangxiaoze.wang/hexo-blog/iShot_2024-04-13_21.06.56.png" width="300" height="600" />

当然上面的例子只是一个简单的了解主题切换，但是数据是短暂的，没有持久性；

有些软件会记录用户的设置，比如微信，银行软件等等，记录用户设置的字体大小；

我们想要做到类似记录上一次的值也是需要一些插件的，`Provider, getx`等等；

1. `Provider`：[Github](https://github.com/rrousselGit/provider)，[官方](https://pub.dev/packages/provider)
2. `Getx`：[Github](https://github.com/jonataslaw/getx)，[官方](https://pub.dev/packages/get)

具体做法可以参考官网，这里有一个我之前做的`Demo`

<iframe src="https://learn-flutter.wangxiaoze.wang/#/others/editTheme" width="100%" height="500" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe>
